<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.home.profile.member.repository.MemberProfileMapper">

    <!-- 회원 정보 조회 -->
    <select id="findMemberById" resultType="com.ssafy.home.profile.member.dto.MemberResponse">
        SELECT mid, phone_num, email, profile_image_url, last_login, created_at, updated_at
        FROM member
        WHERE mid = #{memberId}
    </select>

    <!-- 회원 정보 수정 -->
    <update id="updateMemberProfile">
        UPDATE member
        SET phone_num = #{request.phoneNum}, name = #{request.name}
        <if test="image != null">
            , profile_image_url = #{image}
        </if>
        WHERE mid = #{memberId}
    </update>

    <!-- 회원 탈퇴 -->
    <delete id="deleteMemberProfile">
        DELETE FROM member WHERE mid = #{memberId}
    </delete>

    <!-- 비밀번호 변경 -->
    <update id="updatePassword">
        UPDATE member
        SET password = #{newPassword},
            salt     = #{salt}
        WHERE mid = #{memberId}
    </update>
</mapper>
